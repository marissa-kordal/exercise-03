---
title: "EDA-challenge"
date: 02-06-26
format: html
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.


```{r}
d<- read.csv("data-wrangling.csv") ##read in the dataset data-wrangling 

library(tidyverse) ##load the packages we will need 
library(dplyr)

names(d) #look at the different variables included in the data set

```
```{r}
#Step 1

#1. create a new variable named BSD(body size dimorphism) which is the ratio of average male to female body mass. 

 

bsd<- d%>%
  mutate(BSD = Body_mass_male_mean/Body_mass_female_mean)##adding a new column with mutate called BSD and specifing that the data should be the ratio of average male to female body mass. 

#2. Create a new variable named sex_ratio, which is the ratio of the number of adult females to adult males in a typical group.

sr<- bsd%>%
  mutate(sex_ratio = AdultFemale/AdultMales) #creating a new column with mutate called sex_ratio. ratio is derived by taking the number of adult females divided by adult males

#3. Create a new variable named DI (for “defensibility index”), which is the ratio of day range length to the diameter of the home range.

di<- sr%>%
  mutate(hr_diameter = 2*(sqrt(HomeRange_km2/pi)))%>%
  mutate(DI = DayLength_km/hr_diameter)

head(di)

#4. Plot the relationship between day range length (y axis) and time spent moving (x axis), for these primate species overall and by family 

library(ggplot2)

plot1<-ggplot()+ 
  geom_point(data = di, aes(x= Move, y = DayLength_km, color = factor(Family)), na.rm = TRUE)+
  theme_classic()
#using ggplot, specifying the data in geom_point and plotting the time spent moving on the x axis and the day range length on the Y axis. Coloring the points by family by using factor and taking out the NAs using na.rm

plot2<- ggplot()+ 
  geom_point(data = di, aes(x= Move, y = DayLength_km, color = factor(Family)), na.rm = TRUE)+
  theme_classic()+
  facet_wrap("Family")
#same as plot1 but used facet wrap to make a plot for each family group.

#Overall, there is not a trend that species who spend more time moving travel further overall. Within families, there is also no trend that species spend more time moving travel further. No you should not transform the data because they are on similar scales. 

#5. Plot the relationship between day range length (y axis) and group size (x axis), overall and by family.


plot3<-ggplot(data = di, aes(x= as.numeric(MeanGroupSize), y = DayLength_km), na.rm = TRUE)+ 
  geom_point(aes(color = factor(Family)))+
  theme_classic()+
  geom_smooth(method = "lm")

plot4<-ggplot(data = di, aes(x= as.numeric(MeanGroupSize), y = DayLength_km), na.rm = TRUE)+ 
  geom_point(aes(color = factor(Family)))+
  theme_classic()+
  geom_smooth(method = "lm")+
  facet_wrap("Family")

#yes species that live in groups travel further overall in a day. Many of the species within groups also exhibit this trend as well. Cercopithecidae does as well as Pitheciidae. 

#6. Plot the relationship between canine size dimorphism (y axis) and body size dimorphism (x axis) overall and by family.

names(di)

plot5<-ggplot(data = di, aes(x= BSD, y = Canine_Dimorphism), na.rm = TRUE)+ 
  geom_point(aes(color = factor(Family)))+
  theme_classic()+
  geom_smooth(method = "lm")

plot6<- ggplot(data = di, aes(x=BSD, y= Canine_Dimorphism), na.rm = TRUE)+
  geom_point(aes(color = factor(Family)))+
  theme_classic()+
  geom_smooth(method = "lm")+
  facet_wrap("Family")

##Some taxa with greater size dimorphism also show greater canine dimorphism such as cebidae and cercopithecidae but other taxa actually show smaller canine dimorphism with greater body dimorphism such as Atelidae and Lemuridae. 

#7. Create a new variable named diet_strategy that is “frugivore” if fruits make up >50% of the diet, “folivore” if leaves make up >50% of the diet, and “omnivore” if diet data are available but neither of these is true (i.e., these values are not NA).

ds<-di%>%
  mutate(diet_strategy = case_when(Fruit > 50 ~ "frugivore", Leaves > 50 ~ "folivore", is.na(Fruit) ~ "NA", TRUE ~ "omnivore", is.na(Leaves) ~ "NA"))%>%
  drop_na()

##using mutate to make a new column, then using case_when to dictacte what populates that column and then dropping NAs from the category 

#Then, create boxplots of group size for species with different dietary strategies, omitting the category NA from your plot.
names(ds)
plot7<- ggplot(data = ds, aes(x=diet_strategy, y=MeanGroupSize))+
  geom_boxplot()+
  theme_classic()
#plotting the diet strategey on the x axis and mean group size on the y axis 
##yes frugivores live in larger groups than folivores 

#8. In one line of code, using {dplyr} verbs and the forward pipe (|> or %>%) operator, do the following:

df<-ds%>%
  mutate(Binomial = paste0(Genus, " ", Species))%>% #making a new column named Binomial name with the genus and species name
  select(Binomial, Family, Brain_Size_Species_Mean, Body_mass_male_mean)%>% #selecting only the columns I want to work with
  group_by(Family)%>% #and grouping them by family
  summarize(avg_brain_size = mean(Brain_Size_Species_Mean, na.rm = TRUE), avg_male_mass = mean(Body_mass_male_mean, na.rm = TRUE))%>%
  arrange(avg_brain_size)## using summarize to calculate and create columns for average brain size and average male mass and then arranging them in increasing average brian size. 
print(df)
```